---
title: appinstaller_pid_0002_handler_invoked_network_conn.yaml
intel:
  description:
    - AppInstaller.exe is spawned by the default handler for the URI
    - it attempts to load/install a package from the URL and is saved in INetCache
  detectType: single_line_match
  detectCon: 4
  detectLanguage: kql
  tags:
    - lolbin
  attackTechnique: t1105
  attackSoftware:
  references:
  emulation:
  pattern:
dataRequirements:
  dataSource: windows_os
  dataType:
    - connection_all
  dataCollector: m365d_agent
  dataForwardTo: m365d_security_center
  dataParser:
  dataStorage: m365d_security_center
  dataTable: device_network_events
  dataIndex:
  dataAccess: api_advanced_hunting
  dataMap:
logic:
  kqlVar:
  kqlTable: DeviceNetworkEvents
  kqlQuery: | 
    | where InitiatingProcessFileName contains 'appinstaller'
    | where RemoteUrl contains 'https:'
      or RemoteUrl contains 'http:'