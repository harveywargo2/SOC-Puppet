---
title: builtin_pid_0002_msdt_follina_alerts
intel:
  description:
    - Builtin Alerts from msdt follina 0 day
    - Builtin alert filter/aggregator
  detectType: single_line_match
  detectCon: 2
  detectLanguage: kql
  tags:
    - follina
    - lolbin
    - cve-2022-30190
  attackTechnique: t1003
  attackSoftware:
  references:
  emulation:
  pattern:
dataRequirements:
  dataSource: windows_os
  dataType: alert_evidence
  dataCollector: m365d_agent
  dataForwardTo: m365d_security_center
  dataParser:
  dataStorage: m365d_security_center
  dataTable: alert_evidence
  dataIndex:
  dataAccess: api_advanced_hunting
  dataMap:
logic:
  kqlVar: |
    let AlertName = dynamic(['Suspicious msdt.exe behavior', 
      'Suspicious behavior by an Office application',
      'Suspicious behavior by Msdt.exe', 
      'Possible exploitation attempt of CVE-2022-30190',
      'Trojan:Win32/Mesdetty.A', 
      'Trojan:Win32/Mesdetty.B', 
      'Behavior:Win32/MesdettyLaunch.A!blk',
      'Trojan:Win32/MesdettyScript.A', 
      'Trojan:Win32/MesdettyScript.B', 
      'Behavior:Win32/MesdettyPayload.B',
      'Behavior:Win32/MesdettyLaunch.D']);
    let AlertKeyWord = dynamic(['MSDT']);
  kqlTable: AlertEvidence
  kqlQuery: | 
    | extend Trigger = case(Title in~ (AlertName), 'Title Trigger',
      Title has_any (AlertKeyWord), 'Title Keyword Trigger' ,
      ThreatFamily has_any (AlertKeyWord), 'Threat Family Keyword' , '')
    | where isnotempty(Trigger)
      and DetectionSource !contains 'Custom'