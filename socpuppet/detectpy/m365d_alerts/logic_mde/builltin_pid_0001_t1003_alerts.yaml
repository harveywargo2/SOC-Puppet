---
title: builtin_pid_0001_t1003_alerts
intel:
  description:
    - Builtin Alerts tagged with T1003
    - Alerts that trigger from t1003 emulations
    - Builtin alert filter/aggregator
  detectType: single_line_match
  detectCon: 2
  detectLanguage: kql
  tags:
    -
  attackTechnique: t1003
  attackSoftware:
  references:
  emulation:
    -
  pattern:
    -
dataRequirements:
  dataSource:
    - windows_os
    - mac_oc
    - linux_os
  dataType: alert_evidence
  dataCollector: m365d_agent
  dataForwardTo: m365d_security_center
  dataParser:
  dataStorage: m365d_security_center
  dataTable: alert_evidence
  dataIndex:
  dataAccess: api_advanced_hunting
  dataMap:
logic:
  kqlVar: |
    let AlertName = dynamic(['Process memory dump', 
      'Suspicious access to LSASS service',
      'Endpoint attack notifications: Credential theft activity', 
      'Sensitive credential memory read',
      'Malicious credential theft tool execution detected', 
      'Possible attempt to steal credentials']);
    let AlertKeyWord = dynamic(['DumpLsass', 'LsassDump', 'RundllLolBin', 'pypykatz', 'minidump', 'wincred',
      'mimikatz', 'MiniDump', 'PowerSploit', 'Lazagne']);
  kqlTable: AlertEvidence
  kqlQuery: | 
    | extend Trigger = case(Title in~ (AlertName), 'Title Trigger',
      Title has_any (AlertKeyWord), 'Title Keyword Trigger' ,
      ThreatFamily has_any (AlertKeyWord), 'Threat Family Keyword' ,
      AttackTechniques contains 'T1003' , 'Attack Technique ID', '')
    | where isnotempty(Trigger)
      and DetectionSource !contains 'Custom'