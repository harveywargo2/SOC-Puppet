---
title: msdt_follina
pid: mdebuiltin_p2000
description: Builtin Alerts associated with Follina 0 day
metaData:
  attackTechnique: t1003
  attackSoftware:
  detectUseCase:
  detectType: single_line_match
  detectCon: 1
  platform: m365d
  dataFlow:
    - msft defender endpoint or m365d agent <on>
    - any device <logs>
    - mde alerting component <forwards to>
    - AlertEvidence and AlertInfo <data table>
  tags:
    - lol
kqlDetect:
  kqlVar: |
    let AlertName = dynamic(['Suspicious msdt.exe behavior', 
      'Suspicious behavior by an Office application',
      'Suspicious behavior by Msdt.exe', 
      'Possible exploitation attempt of CVE-2022-30190',
      'Trojan:Win32/Mesdetty.A', 
      'Trojan:Win32/Mesdetty.B', 
      'Behavior:Win32/MesdettyLaunch.A!blk',
      'Trojan:Win32/MesdettyScript.A', 
      'Trojan:Win32/MesdettyScript.B', 
      'Behavior:Win32/MesdettyPayload.B',
      'Behavior:Win32/MesdettyLaunch.D']);
    let AlertKeyWord = dynamic(['MSDT']);
  kqlTable: AlertEvidence
  kqlQuery: | 
    | extend Trigger = case(Title in~ (AlertName), 'Title Trigger',
      Title has_any (AlertKeyWord), 'Title Keyword Trigger' ,
      ThreatFamily has_any (AlertKeyWord), 'Threat Family Keyword' , '')
    | where isnotempty(Trigger)
      and DetectionSource !contains 'Custom'